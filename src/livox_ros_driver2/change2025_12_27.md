译错误原因总结

  主要问题
  livox_ros_driver2 编译失败，报错：
   1 CMake Error: The following variables are used in this project, but they are set to
     NOTFOUND.
   2 /home/rq/radar/livox_ws/src/livox_ros_driver2/LIVOX_INTERFACES_INCLUDE_DIRECTORIES

  根本原因分析

   1. 缺少依赖包路径
      - Livox-SDK2 在工作空间根目录，不在 src 目录
      - CMakeLists.txt 中库文件和头文件查找路径不完整

   2. ROS版本变量未设置
      - 代码中检查 HUMBLE_ROS 变量，但该变量从未被定义
      - 导致 Humble 版本的处理逻辑无法正确执行

   3. 接口包含目录获取失败
      - 对于 Humble 版本，LIVOX_INTERFACES_INCLUDE_DIRECTORIES 变量未正确设置
      - 导致编译时找不到自定义消息的头文件

  我的所有改动

  1. 移动 Livox-SDK2 位置
   1 mv /home/rq/radar/livox_ws/Livox-SDK2 /home/rq/radar/livox_ws/src/

  2. 修改 CMakeLists.txt 中的库文件查找路径
   1 # 原代码
   2 find_library(LIVOX_LIDAR_SDK_LIBRARY liblivox_lidar_sdk_shared.so /usr/local/lib
     REQUIRED)
   3 
   4 # 修改后
   5 find_library(LIVOX_LIDAR_SDK_LIBRARY liblivox_lidar_sdk_shared.so
   6   PATHS /usr/local/lib ~/lib /home/rq/radar/livox_ws/src/Livox-SDK2/build/sdk_core
   7   REQUIRED)

  3. 修改 CMakeLists.txt 中的头文件查找路径
    1 # 原代码
    2 find_path(LIVOX_LIDAR_SDK_INCLUDE_DIR
    3   NAMES "livox_lidar_api.h" "livox_lidar_def.h"
    4   REQUIRED)
    5 
    6 # 修改后
    7 find_path(LIVOX_LIDAR_SDK_INCLUDE_DIR
    8   NAMES "livox_lidar_api.h" "livox_lidar_def.h"
    9   PATHS /usr/local/include ~/include /home/rq/radar/livox_ws/src/Livox-SDK2/sdk_core
   10   REQUIRED)

  4. 添加 ROS 版本变量设置
   1 # 添加了这行
   2 set(HUMBLE_ROS "humble")

  5. 修复 Humble 版本的接口包含目录获取
    1 # 原代码（HUMBLE_ROS 分支）
    2 if(HUMBLE_ROS STREQUAL "humble")
    3   rosidl_get_typesupport_target(cpp_typesupport_target
    4   ${LIVOX_INTERFACES} "rosidl_typesupport_cpp")
    5   target_link_libraries(${PROJECT_NAME} "${cpp_typesupport_target}")
    6 endif()
    7 
    8 # 修改后
    9 if(HUMBLE_ROS STREQUAL "humble")
   10   rosidl_get_typesupport_target(cpp_typesupport_target
   11   ${LIVOX_INTERFACES} "rosidl_typesupport_cpp")
   12   target_link_libraries(${PROJECT_NAME} "${cpp_typesupport_target}")
   13   # For Humble, set the include directories manually
   14   set(LIVOX_INTERFACES_INCLUDE_DIRECTORIES "${CMAKE_CURRENT_BINARY_DIR}/
      ${LIVOX_INTERFACES}")
   15 endif()

  编译成功验证

  最终编译成功，雷达驱动正常启动：
   - 驱动版本：1.2.4
   - 配置文件：HAP_config.json
   - 数据格式：PointCloud2
   - 雷达 IP：192.168.1.100

✦ 现在可以使用新的雷达驱动进行标定了。

